import{reactExports as e,jsxRuntimeExports as t}from"./vendor-C2kiMEl7.es.js";import{MEDIA_EDITOR_VIEW as i,useSduiExpression as a,useSduiStore as n,CROP_RATIOS as l,filesWithEditDataToMediaList as o,useMediaImageEditor as s,getFileUrl as d,MediaEditData as r,MediaImageEditorCanvas as m,MediaEditorToolbar as g,MediaFileManager as p,MediaEditorViewWrapper as c,MediaImageFilters as C,MediaAltTextEditor as E,AddImage as _,clientMediaFileStore as x}from"./sdui-B6vuGh1a.es.js";import{useI18n as h}from"./como-BdllHl_7.es.js";import{Box as u,Image as I,Column as y,Button as A}from"./ui-Dyv4w4YO.es.js";/* empty css                    */import"./delux-sortable-DrNx_pVu.es.js";let f=Object.freeze(Object.defineProperty({__proto__:null,MediaEditorV2:function({input:f,editorConfig:j,outputMediaList:R,onComplete:T,tagEditor:F}={}){let[N,O]=e.useState(i.FILE_MANAGER),M=a(f),[v,G]=e.useState(0),[b,w]=e.useState(M?.mediaFiles??[]),k=a(j?.enableImageFilters),D=a(j?.enableImageAdjustmentSliders),{setValue:L}=n(),{t:S}=h(),B=l[j?.supportedCropRatios?.[0]??"CropRatio_Original"]||l.CropRatio_Original,V=e.useCallback((e,t)=>{if(!b.length)return;let i=o([{file:e,editData:t}]);if(i?.mediaFiles?.[0]){let e=[...b];e[v]=i.mediaFiles[0],w(e)}},[b,v]),[z,W]=s(b[v],B,e.useCallback((e,t)=>{V(e,t),O(i.FILE_MANAGER)},[V])),K=b[v],P=K?d(K):void 0,Z=r.create(),U=e=>{if(!e||0===e.length)return;let t=[...b,...e.map(e=>{let t=crypto.randomUUID(),i=e.webkitRelativePath||t;return x.setItem(t,e),i!==t&&x.setItem(i,e),{metadata:void 0,fileName:e.name,source:{$case:"localFile",localFile:{fileName:e.name,mimeType:e.type,filePointer:i}},size:e.size.toString(),mimeType:e.type,filePointer:i,mediaFileId:t,editData:Z,captions:[],thumbnails:[]}})];w(t),G(t.length-1),R?.key&&L(R.key,{mediaFiles:t}),O(i.FILE_MANAGER)};return t.jsxs(u,{display:"grid",style:{height:"100%",gridTemplateColumns:"3fr 2fr 0.5fr",gridTemplateRows:"1fr auto auto"},children:[t.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",style:{gridColumn:"1",gridRow:"1",overflow:"hidden"},children:N===i.IMAGE_EDITOR?t.jsx(m,{canvasKey:z.canvasKey,onReady:z.onReady,hasContentCredentials:z.hasContentCredentials,isImageEdited:z.isImageEdited,isContentCredentialsTooltipOpen:z.isContentCredentialsTooltipOpen,setIsContentCredentialsTooltipOpen:z.setIsContentCredentialsTooltipOpen,isContentCredentialsWarningOpen:z.isContentCredentialsWarningOpen,setIsContentCredentialsWarningOpen:z.setIsContentCredentialsWarningOpen}):t.jsx(I,{src:P,a11yText:S("media_editor_image_preview"),imageScalingType:"contain",width:"100%",height:"100%"})}),N===i.FILE_MANAGER&&t.jsx(u,{display:"flex",justifyContent:"center",style:{gridColumn:"1",gridRow:"2"},children:t.jsx(g,{activeView:N,onViewChange:O,selectedFile:K})}),t.jsx(u,{inset:"2x",display:"flex",flexDirection:"column",style:{gridColumn:"2",gridRow:"1 / 3",overflow:"auto"},children:t.jsxs(y,{gap:"2x",height:"100%",children:[N===i.FILE_MANAGER&&t.jsx(p,{files:b,selectedIndex:v,onSelectionChange:G,onFilesChange:w,onFilesAdded:U,onViewChange:e=>O(e)}),N===i.IMAGE_EDITOR&&t.jsx(c,{title:S("media_editor_edit"),onBack:()=>O(i.FILE_MANAGER),children:t.jsx(C,{imageRef:z.imageRef,editData:z.editData,initialZoom:z.initialZoom,initialStraightenAngle:z.initialStraightenAngle,initialRotate:z.initialRotate,onEdit:z.onImageEdit,enableImageFilters:k,enableImageAdjustmentSliders:D,isImageEdited:z.isImageEdited,onApplyEdits:W})}),N===i.TAG_EDITOR&&t.jsx(c,{title:S("media_editor_add_tag"),onBack:()=>O(i.FILE_MANAGER),children:F}),N===i.ALT_TEXT_EDITOR&&t.jsx(c,{title:S("media_editor_add_alt_text"),onBack:()=>O(i.FILE_MANAGER),children:t.jsx(E,{initialAltText:K?.metadata?.altText,onSave:e=>{K&&(w(b.map(t=>t.mediaFileId===K.mediaFileId?{...t,metadata:{...t.metadata,altText:e}}:t)),O(i.FILE_MANAGER))}})}),N===i.ADD_IMAGE&&t.jsx(c,{onBack:()=>O(i.FILE_MANAGER),children:t.jsx(_,{onFilesAdded:U,onViewChange:O})})]})}),t.jsx(u,{borderTop:"divider",insetX:"3x",insetY:"1.5x",tagName:"footer",justifyContent:"flexEnd",display:"flex",style:{gridColumn:"1 / 4",gridRow:"3"},children:t.jsx(A,{category:"primary",isEmphasized:!0,onClick:()=>{R?.key&&b.length>0&&L(R.key,{$type:"proto.sdui.media.MediaList",mediaFiles:b}),T?.()},text:S("media_editor_save")})})]})}},Symbol.toStringTag,{value:"Module"}));export{f as CLIENT_COMPONENT_f2b4d044c030b948b6809a8941429c7a};